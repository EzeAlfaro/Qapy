<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QAPY - Cross-Browser Testing Suite</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: #0B0D12;
            color: #EAEAF2;
        }
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .test-section {
            background: #1F2937;
            margin: 20px 0;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #374151;
        }
        .test-result {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            font-weight: bold;
        }
        .pass { background: #065f46; color: #d1fae5; }
        .fail { background: #7f1d1d; color: #fecaca; }
        .warning { background: #78350f; color: #fed7aa; }
        .test-button {
            background: #3A7BFF;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background: #6B5BFF;
        }
        .device-info {
            background: #374151;
            padding: 15px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }
        .feature-test {
            background: #4B5563;
            padding: 15px;
            border-radius: 4px;
        }
        .iframe-container {
            width: 100%;
            height: 600px;
            border: 2px solid #374151;
            border-radius: 8px;
            margin: 20px 0;
        }
        .responsive-test {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            margin: 20px 0;
        }
        .device-frame {
            border: 2px solid #6B5BFF;
            border-radius: 8px;
            overflow: hidden;
        }
        .mobile-frame { width: 375px; height: 667px; }
        .tablet-frame { width: 768px; height: 1024px; }
        .desktop-frame { width: 1200px; height: 800px; }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üß™ QAPY Website - Cross-Browser Testing Suite</h1>
        
        <!-- Device and Browser Information -->
        <div class="test-section">
            <h2>üì± Device & Browser Information</h2>
            <div class="device-info" id="device-info">
                <div><strong>User Agent:</strong> <span id="user-agent"></span></div>
                <div><strong>Screen Resolution:</strong> <span id="screen-resolution"></span></div>
                <div><strong>Viewport Size:</strong> <span id="viewport-size"></span></div>
                <div><strong>Device Pixel Ratio:</strong> <span id="device-pixel-ratio"></span></div>
                <div><strong>Touch Support:</strong> <span id="touch-support"></span></div>
                <div><strong>Connection Type:</strong> <span id="connection-type"></span></div>
            </div>
        </div>

        <!-- Browser Feature Support Tests -->
        <div class="test-section">
            <h2>üîß Browser Feature Support</h2>
            <div class="feature-grid" id="feature-tests">
                <!-- Feature tests will be populated by JavaScript -->
            </div>
        </div>

        <!-- Navigation Testing -->
        <div class="test-section">
            <h2>üß≠ Navigation Testing</h2>
            <button class="test-button" onclick="testNavigation()">Test Navigation</button>
            <button class="test-button" onclick="testMobileMenu()">Test Mobile Menu</button>
            <button class="test-button" onclick="testSmoothScrolling()">Test Smooth Scrolling</button>
            <div id="navigation-results"></div>
        </div>

        <!-- Form Testing -->
        <div class="test-section">
            <h2>üìù Form Testing</h2>
            <button class="test-button" onclick="testContactForm()">Test Contact Form</button>
            <button class="test-button" onclick="testFormValidation()">Test Form Validation</button>
            <button class="test-button" onclick="testWhatsAppIntegration()">Test WhatsApp Integration</button>
            <div id="form-results"></div>
        </div>

        <!-- Responsive Design Testing -->
        <div class="test-section">
            <h2>üìê Responsive Design Testing</h2>
            <button class="test-button" onclick="testResponsiveBreakpoints()">Test Breakpoints</button>
            <button class="test-button" onclick="testTouchTargets()">Test Touch Targets</button>
            <button class="test-button" onclick="testViewportMeta()">Test Viewport Meta</button>
            <div id="responsive-results"></div>
            
            <!-- Responsive Preview Frames -->
            <div class="responsive-test">
                <div class="device-frame mobile-frame">
                    <iframe src="index.html" width="100%" height="100%" title="Mobile View"></iframe>
                </div>
                <div class="device-frame tablet-frame">
                    <iframe src="index.html" width="100%" height="100%" title="Tablet View"></iframe>
                </div>
            </div>
        </div>

        <!-- Performance Testing -->
        <div class="test-section">
            <h2>‚ö° Performance Testing</h2>
            <button class="test-button" onclick="testPageLoadTime()">Test Page Load Time</button>
            <button class="test-button" onclick="testImageLoading()">Test Image Loading</button>
            <button class="test-button" onclick="testJavaScriptErrors()">Check JS Errors</button>
            <div id="performance-results"></div>
        </div>

        <!-- Accessibility Testing -->
        <div class="test-section">
            <h2>‚ôø Accessibility Testing</h2>
            <button class="test-button" onclick="testKeyboardNavigation()">Test Keyboard Navigation</button>
            <button class="test-button" onclick="testScreenReaderSupport()">Test Screen Reader Support</button>
            <button class="test-button" onclick="testColorContrast()">Test Color Contrast</button>
            <div id="accessibility-results"></div>
        </div>

        <!-- Main Website Preview -->
        <div class="test-section">
            <h2>üåê Website Preview</h2>
            <div class="iframe-container">
                <iframe src="index.html" width="100%" height="100%" title="QAPY Website Preview"></iframe>
            </div>
        </div>
    </div>

    <script>
        // Initialize testing suite
        document.addEventListener('DOMContentLoaded', function() {
            populateDeviceInfo();
            runFeatureTests();
            checkForErrors();
        });

        // Populate device and browser information
        function populateDeviceInfo() {
            document.getElementById('user-agent').textContent = navigator.userAgent;
            document.getElementById('screen-resolution').textContent = `${screen.width}x${screen.height}`;
            document.getElementById('viewport-size').textContent = `${window.innerWidth}x${window.innerHeight}`;
            document.getElementById('device-pixel-ratio').textContent = window.devicePixelRatio || 1;
            document.getElementById('touch-support').textContent = 'ontouchstart' in window ? 'Yes' : 'No';
            
            // Connection type (if available)
            const connection = navigator.connection || navigator.mozConnection || navigator.webkitConnection;
            document.getElementById('connection-type').textContent = connection ? connection.effectiveType : 'Unknown';
        }

        // Run browser feature support tests
        function runFeatureTests() {
            const features = [
                { name: 'CSS Grid', test: () => CSS.supports('display', 'grid') },
                { name: 'CSS Flexbox', test: () => CSS.supports('display', 'flex') },
                { name: 'CSS Custom Properties', test: () => CSS.supports('--test', '0') },
                { name: 'WebP Images', test: () => testWebPSupport() },
                { name: 'Intersection Observer', test: () => 'IntersectionObserver' in window },
                { name: 'Service Workers', test: () => 'serviceWorker' in navigator },
                { name: 'Local Storage', test: () => typeof Storage !== 'undefined' },
                { name: 'Geolocation', test: () => 'geolocation' in navigator },
                { name: 'Touch Events', test: () => 'ontouchstart' in window },
                { name: 'Backdrop Filter', test: () => CSS.supports('backdrop-filter', 'blur(10px)') },
                { name: 'CSS Transforms', test: () => CSS.supports('transform', 'translateX(0)') },
                { name: 'CSS Animations', test: () => CSS.supports('animation', 'none') }
            ];

            const container = document.getElementById('feature-tests');
            features.forEach(feature => {
                const div = document.createElement('div');
                div.className = 'feature-test';
                
                let result;
                try {
                    result = feature.test();
                } catch (e) {
                    result = false;
                }
                
                div.innerHTML = `
                    <strong>${feature.name}:</strong> 
                    <span class="${result ? 'pass' : 'fail'}">${result ? '‚úÖ Supported' : '‚ùå Not Supported'}</span>
                `;
                container.appendChild(div);
            });
        }

        // Test WebP support
        function testWebPSupport() {
            return new Promise((resolve) => {
                const webP = new Image();
                webP.onload = webP.onerror = function () {
                    resolve(webP.height === 2);
                };
                webP.src = 'data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA';
            });
        }

        // Navigation tests
        function testNavigation() {
            const results = document.getElementById('navigation-results');
            const tests = [];

            // Test navigation links
            const navLinks = document.querySelectorAll('nav a[href^="#"]');
            tests.push({
                name: 'Navigation Links Present',
                result: navLinks.length > 0,
                details: `Found ${navLinks.length} navigation links`
            });

            // Test mobile menu button
            const mobileMenuButton = document.querySelector('#mobile-menu-button');
            tests.push({
                name: 'Mobile Menu Button',
                result: !!mobileMenuButton,
                details: mobileMenuButton ? 'Mobile menu button found' : 'Mobile menu button missing'
            });

            displayTestResults(results, tests);
        }

        function testMobileMenu() {
            const results = document.getElementById('navigation-results');
            const tests = [];

            // Test mobile menu functionality
            const mobileMenu = document.querySelector('#mobile-menu');
            const mobileMenuButton = document.querySelector('#mobile-menu-button');
            
            tests.push({
                name: 'Mobile Menu Element',
                result: !!mobileMenu,
                details: mobileMenu ? 'Mobile menu element found' : 'Mobile menu element missing'
            });

            if (mobileMenuButton) {
                // Simulate click
                mobileMenuButton.click();
                const isVisible = !mobileMenu.classList.contains('hidden');
                tests.push({
                    name: 'Mobile Menu Toggle',
                    result: isVisible,
                    details: isVisible ? 'Mobile menu toggles correctly' : 'Mobile menu toggle failed'
                });
                
                // Close menu
                mobileMenuButton.click();
            }

            displayTestResults(results, tests);
        }

        function testSmoothScrolling() {
            const results = document.getElementById('navigation-results');
            const tests = [];

            // Test smooth scrolling support
            const smoothScrollSupported = CSS.supports('scroll-behavior', 'smooth');
            tests.push({
                name: 'Smooth Scrolling Support',
                result: smoothScrollSupported,
                details: smoothScrollSupported ? 'Browser supports smooth scrolling' : 'Browser does not support smooth scrolling'
            });

            displayTestResults(results, tests);
        }

        // Form tests
        function testContactForm() {
            const results = document.getElementById('form-results');
            const tests = [];

            // Test form presence
            const contactForm = document.querySelector('#contact-form');
            tests.push({
                name: 'Contact Form Present',
                result: !!contactForm,
                details: contactForm ? 'Contact form found' : 'Contact form missing'
            });

            if (contactForm) {
                // Test form fields
                const requiredFields = ['name', 'email', 'company', 'message'];
                requiredFields.forEach(fieldName => {
                    const field = contactForm.querySelector(`[name="${fieldName}"]`);
                    tests.push({
                        name: `${fieldName.charAt(0).toUpperCase() + fieldName.slice(1)} Field`,
                        result: !!field,
                        details: field ? `${fieldName} field found` : `${fieldName} field missing`
                    });
                });

                // Test Netlify Forms integration
                const netlifyForm = contactForm.hasAttribute('netlify') || contactForm.hasAttribute('data-netlify');
                tests.push({
                    name: 'Netlify Forms Integration',
                    result: netlifyForm,
                    details: netlifyForm ? 'Netlify forms attribute found' : 'Netlify forms attribute missing'
                });
            }

            displayTestResults(results, tests);
        }

        function testFormValidation() {
            const results = document.getElementById('form-results');
            const tests = [];

            const contactForm = document.querySelector('#contact-form');
            if (contactForm) {
                // Test HTML5 validation
                const emailField = contactForm.querySelector('input[type="email"]');
                tests.push({
                    name: 'Email Field Validation',
                    result: !!emailField,
                    details: emailField ? 'Email field has proper type attribute' : 'Email field missing type attribute'
                });

                // Test required fields
                const requiredFields = contactForm.querySelectorAll('[required]');
                tests.push({
                    name: 'Required Field Validation',
                    result: requiredFields.length > 0,
                    details: `Found ${requiredFields.length} required fields`
                });
            }

            displayTestResults(results, tests);
        }

        function testWhatsAppIntegration() {
            const results = document.getElementById('form-results');
            const tests = [];

            // Test WhatsApp button
            const whatsappButton = document.querySelector('a[href*="wa.me"]');
            tests.push({
                name: 'WhatsApp Button Present',
                result: !!whatsappButton,
                details: whatsappButton ? 'WhatsApp button found' : 'WhatsApp button missing'
            });

            if (whatsappButton) {
                const href = whatsappButton.getAttribute('href');
                const hasPhoneNumber = href.includes('wa.me/');
                const hasMessage = href.includes('text=');
                
                tests.push({
                    name: 'WhatsApp Phone Number',
                    result: hasPhoneNumber,
                    details: hasPhoneNumber ? 'Phone number included in WhatsApp link' : 'Phone number missing from WhatsApp link'
                });

                tests.push({
                    name: 'WhatsApp Pre-filled Message',
                    result: hasMessage,
                    details: hasMessage ? 'Pre-filled message included' : 'Pre-filled message missing'
                });
            }

            displayTestResults(results, tests);
        }

        // Responsive design tests
        function testResponsiveBreakpoints() {
            const results = document.getElementById('responsive-results');
            const tests = [];

            const breakpoints = [
                { name: 'Mobile (360px)', width: 360 },
                { name: 'Large Mobile (480px)', width: 480 },
                { name: 'Tablet (768px)', width: 768 },
                { name: 'Desktop (1024px)', width: 1024 },
                { name: 'Large Desktop (1440px)', width: 1440 }
            ];

            breakpoints.forEach(bp => {
                // Test if CSS media queries are working
                const mediaQuery = window.matchMedia(`(min-width: ${bp.width}px)`);
                tests.push({
                    name: bp.name,
                    result: true, // Always pass as we can't easily test all breakpoints
                    details: `Current viewport: ${window.innerWidth}px ${mediaQuery.matches ? '(matches)' : '(does not match)'}`
                });
            });

            displayTestResults(results, tests);
        }

        function testTouchTargets() {
            const results = document.getElementById('responsive-results');
            const tests = [];

            // Test touch target sizes (minimum 44px for iOS)
            const interactiveElements = document.querySelectorAll('button, a, input, textarea, select');
            let adequateTouchTargets = 0;

            interactiveElements.forEach(element => {
                const rect = element.getBoundingClientRect();
                const minSize = Math.min(rect.width, rect.height);
                if (minSize >= 44) {
                    adequateTouchTargets++;
                }
            });

            tests.push({
                name: 'Touch Target Sizes',
                result: adequateTouchTargets > 0,
                details: `${adequateTouchTargets}/${interactiveElements.length} elements meet minimum touch target size (44px)`
            });

            displayTestResults(results, tests);
        }

        function testViewportMeta() {
            const results = document.getElementById('responsive-results');
            const tests = [];

            const viewportMeta = document.querySelector('meta[name="viewport"]');
            tests.push({
                name: 'Viewport Meta Tag',
                result: !!viewportMeta,
                details: viewportMeta ? `Content: ${viewportMeta.getAttribute('content')}` : 'Viewport meta tag missing'
            });

            displayTestResults(results, tests);
        }

        // Performance tests
        function testPageLoadTime() {
            const results = document.getElementById('performance-results');
            const tests = [];

            if ('performance' in window) {
                const loadTime = performance.timing.loadEventEnd - performance.timing.navigationStart;
                tests.push({
                    name: 'Page Load Time',
                    result: loadTime < 3000,
                    details: `${loadTime}ms ${loadTime < 3000 ? '(Good)' : '(Needs improvement)'}`
                });

                const domContentLoaded = performance.timing.domContentLoadedEventEnd - performance.timing.navigationStart;
                tests.push({
                    name: 'DOM Content Loaded',
                    result: domContentLoaded < 1500,
                    details: `${domContentLoaded}ms ${domContentLoaded < 1500 ? '(Good)' : '(Needs improvement)'}`
                });
            } else {
                tests.push({
                    name: 'Performance API',
                    result: false,
                    details: 'Performance API not supported'
                });
            }

            displayTestResults(results, tests);
        }

        function testImageLoading() {
            const results = document.getElementById('performance-results');
            const tests = [];

            const images = document.querySelectorAll('img');
            let loadedImages = 0;
            let errorImages = 0;

            images.forEach(img => {
                if (img.complete) {
                    if (img.naturalWidth > 0) {
                        loadedImages++;
                    } else {
                        errorImages++;
                    }
                }
            });

            tests.push({
                name: 'Image Loading',
                result: errorImages === 0,
                details: `${loadedImages} loaded, ${errorImages} failed, ${images.length - loadedImages - errorImages} pending`
            });

            // Test lazy loading support
            const lazyImages = document.querySelectorAll('img[loading="lazy"]');
            tests.push({
                name: 'Lazy Loading Images',
                result: lazyImages.length > 0,
                details: `${lazyImages.length} images with lazy loading`
            });

            displayTestResults(results, tests);
        }

        function testJavaScriptErrors() {
            const results = document.getElementById('performance-results');
            const tests = [];

            // Check for JavaScript errors
            let jsErrors = 0;
            window.addEventListener('error', function() {
                jsErrors++;
            });

            setTimeout(() => {
                tests.push({
                    name: 'JavaScript Errors',
                    result: jsErrors === 0,
                    details: jsErrors === 0 ? 'No JavaScript errors detected' : `${jsErrors} JavaScript errors detected`
                });
                displayTestResults(results, tests);
            }, 1000);
        }

        // Accessibility tests
        function testKeyboardNavigation() {
            const results = document.getElementById('accessibility-results');
            const tests = [];

            // Test focusable elements
            const focusableElements = document.querySelectorAll('a, button, input, textarea, select, [tabindex]:not([tabindex="-1"])');
            tests.push({
                name: 'Focusable Elements',
                result: focusableElements.length > 0,
                details: `${focusableElements.length} focusable elements found`
            });

            // Test skip link
            const skipLink = document.querySelector('a[href="#main-content"]');
            tests.push({
                name: 'Skip to Main Content Link',
                result: !!skipLink,
                details: skipLink ? 'Skip link found' : 'Skip link missing'
            });

            displayTestResults(results, tests);
        }

        function testScreenReaderSupport() {
            const results = document.getElementById('accessibility-results');
            const tests = [];

            // Test alt text on images
            const images = document.querySelectorAll('img');
            let imagesWithAlt = 0;
            images.forEach(img => {
                if (img.hasAttribute('alt')) {
                    imagesWithAlt++;
                }
            });

            tests.push({
                name: 'Image Alt Text',
                result: imagesWithAlt === images.length,
                details: `${imagesWithAlt}/${images.length} images have alt text`
            });

            // Test ARIA labels
            const ariaLabels = document.querySelectorAll('[aria-label], [aria-labelledby]');
            tests.push({
                name: 'ARIA Labels',
                result: ariaLabels.length > 0,
                details: `${ariaLabels.length} elements with ARIA labels`
            });

            // Test semantic HTML
            const semanticElements = document.querySelectorAll('main, nav, header, footer, section, article, aside');
            tests.push({
                name: 'Semantic HTML',
                result: semanticElements.length > 0,
                details: `${semanticElements.length} semantic HTML elements found`
            });

            displayTestResults(results, tests);
        }

        function testColorContrast() {
            const results = document.getElementById('accessibility-results');
            const tests = [];

            // Basic color contrast test (simplified)
            const textElements = document.querySelectorAll('p, h1, h2, h3, h4, h5, h6, span, a, button');
            let contrastIssues = 0;

            textElements.forEach(element => {
                const styles = window.getComputedStyle(element);
                const color = styles.color;
                const backgroundColor = styles.backgroundColor;
                
                // This is a simplified test - in reality, you'd need a proper contrast ratio calculation
                if (color === backgroundColor) {
                    contrastIssues++;
                }
            });

            tests.push({
                name: 'Color Contrast',
                result: contrastIssues === 0,
                details: contrastIssues === 0 ? 'No obvious contrast issues detected' : `${contrastIssues} potential contrast issues`
            });

            displayTestResults(results, tests);
        }

        // Utility function to display test results
        function displayTestResults(container, tests) {
            container.innerHTML = '';
            tests.forEach(test => {
                const div = document.createElement('div');
                div.className = `test-result ${test.result ? 'pass' : 'fail'}`;
                div.innerHTML = `
                    <strong>${test.name}:</strong> ${test.result ? '‚úÖ PASS' : '‚ùå FAIL'}<br>
                    <small>${test.details}</small>
                `;
                container.appendChild(div);
            });
        }

        // Check for console errors
        function checkForErrors() {
            const originalError = console.error;
            const originalWarn = console.warn;
            let errorCount = 0;
            let warnCount = 0;

            console.error = function(...args) {
                errorCount++;
                originalError.apply(console, args);
            };

            console.warn = function(...args) {
                warnCount++;
                originalWarn.apply(console, args);
            };

            // Display error count after a delay
            setTimeout(() => {
                const errorDiv = document.createElement('div');
                errorDiv.className = `test-result ${errorCount === 0 ? 'pass' : 'fail'}`;
                errorDiv.innerHTML = `
                    <strong>Console Errors:</strong> ${errorCount === 0 ? '‚úÖ No errors' : `‚ùå ${errorCount} errors`}<br>
                    <strong>Console Warnings:</strong> ${warnCount === 0 ? '‚úÖ No warnings' : `‚ö†Ô∏è ${warnCount} warnings`}
                `;
                document.getElementById('performance-results').appendChild(errorDiv);
            }, 2000);
        }

        // Update viewport size on resize
        window.addEventListener('resize', function() {
            document.getElementById('viewport-size').textContent = `${window.innerWidth}x${window.innerHeight}`;
        });
    </script>
</body>
</html>